<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace = "com.example.storage.modules.user.dao.SmsDao">

   <sql id ="SmsColumns">
        `mobile` AS `mobile`,
        `type` AS `type`,
        `code` AS `code`,
        `content` AS `content`,
        `create_time` AS `createTime`
   </sql>
    
   <select id="selectSmsList" resultType = "com.example.storage.modules.user.pojo.po.SmsListPO">
		SELECT <include refid="SmsColumns"/>
		FROM `sms` 
		<where>
		   <if test="phoneNumber != null and phoneNumber !=''">
		      <bind name="phoneNumber" value="'%' + phoneNumber + '%'" />
		      `mobile` LIKE #{phoneNumber} ESCAPE '/'
		   </if>
		   <if test="type != null and type != ''">
		      AND `type` = #{type}
		   </if>
		</where>
		ORDER BY `create_time` desc
   </select>
   
   <select id="selectCount" resultType = "int">
		SELECT COUNT(*) FROM `sms` 
		<where>
		     <if test="phoneNumber != null and phoneNumber !=''">
		        <bind name="phoneNumber" value="'%' + phoneNumber + '%'" />
		        `mobile` LIKE #{phoneNumber} ESCAPE '/'
		     </if>
		     <if test="type != null and type != ''">
		        AND `type` = #{type}
		     </if>
		</where>
   </select>

</mapper>